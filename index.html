<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>张广训的个人网站</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  

  <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">

  <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="stylesheet" href="/css/styles.css">
</head>

<body>
  <nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-menu-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="main-menu-navbar">
      <ul class="nav navbar-nav">
        
          <li><a class="active"
                 href="/index.html">Home</a></li>
        
          <li><a class=""
                 href="/archives/">Archives</a></li>
        
          <li><a class=""
                 href="/about">About</a></li>
        
      </ul>
    </div>
  </div>
</nav>

  
    <div class="blog-head">
      <!-- 该部分内容原本是在_partial/header.ejs中，但无奈is_home()判断编译后github.io无法正常使用 -->
      <div class="blog-header">
        <h3 class="blog-title">衣沾不足惜，但使愿无违。</h3>
      </div>

      <img class="img-responsive img" src="https://raw.githubusercontent.com/zhgxun/images/master/travel/haituo_road.jpg" alt="海坨山-回望来时的路">
    </div>
  

  <div class="container">
    <div class="row">
        
          <div class="col-sm-8 blog-main">
            
  
    <article id="post-yaf" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/13/yaf/">58. 用Yaf写一句hello</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2017/11/13/yaf/" class="article-date"><time datetime="2017-11-13T15:25:30.000Z" itemprop="datePublished">2017-11-13</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/php/">php</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://www.laruence.com/2012/08/31/2742.html" target="_blank" rel="external">关于Yaf的一些说明</a>一文中已经讲到了Yaf的一些额外信息，对于一个想了解这个框架的人来说，已经足够多了。</p>
<p>Yaf框架的前身是鸟哥在百度做PHP顾问时写的，在百度内部叫做AP框架，开源的版本称作Yaf框架。它们之间存在一些差异，但大部分都是相同的。可以说，有大牛经过的地方，都带着他们自己的影子，人走了，但东西都留下，方便了后来的人。</p>
<p>有时候觉得一些东西简单，很方便，比如Yii框架的gii，有时候又觉得什么都没有最好，比如Yaf，什么都自己写，更简单一些。全栈框架一方面确实快捷，但往往表面的东西占据了大多数功能。有种因为走的太远，可能忘记了自己是因为什么而出发的感觉。</p>
<p>所以介绍一下Yaf框架，对于以接口为主的应用来说，确实省掉了大量的扩展，即便是后台，也更简单，稍微维护就可以满足需求。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>安装很简单，现在的机器一般都很少使用源代码编译了，而是直接使用现成的包，比如mac上搜索一下：</p>
<pre><code class="bash">zhgxun-pro:~ zhgxun$ brew search php71-yaf
==&gt; Searching local taps...
homebrew/php/php71-yaf ✔
==&gt; Searching taps on GitHub...
==&gt; Searching blacklisted, migrated and deleted formulae...
zhgxun-pro:~ zhgxun$
</code></pre>
<p>当然线上服务器如果yum无法安装，那就考虑源代码编译吧，现如今编译一个软件，真的是一件很容易的事情了。</p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>比如使用nginx来做web服务器，直接配置应用入口即可：</p>
<pre><code class="conf">zhgxun-pro:~ zhgxun$ cat /usr/local/etc/nginx/servers/yaf.conf
server {
    listen 80;
    server_name yaf.com;
    index index.php index.html;
    root  /Users/zhgxun/Public/html/php/yaf/public;

    if (!-e $request_filename) {
        rewrite ^(.*)$ /index.php/$1 last;
    }


    location ~ [^/]\.php(/|$) {
        fastcgi_pass  127.0.0.1:9000;
        include fastcgi.conf;
    }

    access_log  /Users/zhgxun/Public/html/logs/yaf.log  main;
}
zhgxun-pro:~ zhgxun$
</code></pre>
<p>服务器配置，一般只要公司不是很小，都有专门的运维同学负责，完全轮不到开发啥事。如果轮到了，那说明公司真的很小，你就简单配置一下，就可以支持公司业务了。放心，不要害怕，等公司业务做大了，不要害怕自己不会，会找到更厉害的人来管理的，你只需要做好自己该做的就行了。</p>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><p>目录按照官网给定的即可，很多项目，都不要弄的很复杂，越简单越好。</p>
<pre><code class="bash">zhgxun-pro:php zhgxun$ tree yaf/
yaf/
├── application
│   ├── controllers
│   │   └── Index.php
│   ├── library
│   ├── models
│   ├── modules
│   ├── plugins
│   └── views
│       └── index
│           └── index.html
├── conf
│   └── application.ini
└── public
    ├── css
    ├── img
    ├── index.php
    └── js

13 directories, 4 files
zhgxun-pro:php zhgxun$
</code></pre>
<h2 id="配置-1"><a href="#配置-1" class="headerlink" title="配置"></a>配置</h2><p>Yaf的配置不多，但也要注意一些默认值，可能需要你自己修改：</p>
<pre><code class="php">[product]
;支持直接写PHP中的已定义常量
application.directory=APP_PATH &quot;/application/&quot;
application.view.ext=html
</code></pre>
<p>默认配置已经很好了，但有些很奇怪的配置，可能每个人的适应不同，比如我就看不惯模板文件叫tpl,phtml这类的扩展名，不知道是因为什么，反正是每次看到都有种想要重命名的冲动。</p>
<h2 id="入口"><a href="#入口" class="headerlink" title="入口"></a>入口</h2><p>每个应用都有一个请求入口。</p>
<pre><code class="php">class IndexController extends Yaf_Controller_Abstract
{
    public function indexAction()
    {
        $this-&gt;getView()-&gt;assign(&quot;content&quot;, &quot;Hello World&quot;);
    }
}
</code></pre>
<h2 id="模板"><a href="#模板" class="headerlink" title="模板"></a>模板</h2><p>简单的html标记语言是每个php开发者都需要掌握的知识。不过目前很少需要前后端都要写的情况了，如果有，说明你在的公司真的太小了，是时候需要考虑换一份工作，好好安心写php。</p>
<pre><code class="html">&lt;html&gt;
 &lt;head&gt;
   &lt;title&gt;Hello World&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
  &lt;?php echo $content;?&gt;
 &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>我写最多的时候也是后端，后端需要的js也很少，ajax就可以对付基本的业务。前端不一样，现在都要用vue来做了，jQuery做前端的网站不多了，后端同学不喜欢就不要去学了。知识太多，好好做后端就行。</p>
<h2 id="重写"><a href="#重写" class="headerlink" title="重写"></a>重写</h2><p>因为路由的关系，大多数应用都需要开启重写引擎。</p>
<pre><code class="conf">#.htaccess, 当然也可以写在httpd.conf
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule .* index.php
</code></pre>
<p>好，Yaf框架就说这么多。</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/">php</a></li></ul>


    </footer>
  </div>
  
</article>

  
    <article id="post-flow" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/11/flow/">58. 流量切分</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2017/11/11/flow/" class="article-date"><time datetime="2017-11-11T09:04:31.000Z" itemprop="datePublished">2017-11-11</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/php/">php</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>前不久接到一个需求，新接入一个保险公司，一开始只需要切入20%的流量。一时半会还想不出来有什么好的办法。</p>
<p>其实每个学过编程的人都或多或少接触过这些东西，最常见的莫过于nginx负载均衡了。切分流量也是类似的道理，就跟分库分表一样，就是一种计算规则，将一个用户定位到一个区间上。当让要考虑到正态分布，使其尽可能平均，不要造成一个区间数量过于太大即可。</p>
<p>这次我们采取的方式就是，由于产品是在一个域中，就考虑到用用户的标识COOKIE来处理，当用户未登陆时随机分配一个权值即可。用PHP的方式如下：</p>
<pre><code class="php">function flow()
{
    // 假如当前登陆用户的COOKIE为该值
    $_COOKIE[&#39;id&#39;] = &#39;vW8ySjnxAeLF5cV5-bo4NeL94Mu1SzDMm3myEIdQktiHtW0G&#39;;
    if (isset($_COOKIE[&#39;id&#39;])) {
        $length = strlen($_COOKIE[&#39;id&#39;]);
        $num = 0;
        for ($i = 0; $i &lt; $length; $i++) {
            $num += ord($_COOKIE[&#39;id&#39;][$i]);
        }
        return $num % 100;
    }
    return rand(1, 100);
}

echo &quot;当前权重\n&quot;;
echo flow();
echo &quot;\n&quot;;
</code></pre>
<p>计算结果为：</p>
<pre><code class="bash">zhgxun-pro:php zhgxun$ php flow.php 
当前权重
2
zhgxun-pro:php zhgxun$
</code></pre>
<p>这样业务方就可以根据返回的数值进行后续操作了。</p>

      
    </div>

    
      

    

    <footer class="article-footer">
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/">php</a></li></ul>


    </footer>
  </div>
  
</article>

  
    <article id="post-wutaishan" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/05/wutaishan/">57. 五台山</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2017/10/05/wutaishan/" class="article-date"><time datetime="2017-10-05T03:22:55.000Z" itemprop="datePublished">2017-10-05</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/travel/">travel</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>说起五台山，是些五百年修行，还愿，祈福一类的东西。</p>
<p>中国有四大佛教名山，文殊菩萨道场是山西的五台山；观世音菩萨道场是浙江的普陀山；地藏菩萨道场是安徽的九华山；普贤菩萨的道场是四川峨眉山。观音大悲，地藏大愿，普贤大行，文殊大智。佛家有一句非常著名的话，叫作摩诃般若波罗蜜多，它的意思是用大智慧到达彼岸。</p>
<p>当年康熙就曾经五次前往参拜五台山。据史料记载，他五次前来其中有个很重要的原因是要找寻他的父亲，那就是相传在五台剃发出家的顺治。当然顺治出家根本起因不是想要超越轮回，度脱苦海乃至广度众生，他是因为他的爱妃去世，受到了严重的打击，心灰意冷。</p>
<p>有这么一段出家偈，即佛经中的唱词，跟顺治有关，写的非常好。</p>
<pre><code>天下丛林饭似山，钵盂到处任君餐，黄金白玉非为贵，惟有袈裟披肩难。
朕为大地山河主，忧国忧民事转烦，百年三万六千日，不及僧家半日闲。 
来时糊涂去时迷，空在人间走这回，未曾生我谁是我？生我之时我是谁？
长大成人方是我，合眼朦胧又是谁？不如不来又不去，来时欢喜去时悲。

悲欢离合多劳虑，何日清闲谁得知？若能了达僧家事，从此回头不算迟。
世间难比出家人，无忧无虑得安宜，口中吃得清和味，身上常穿百衲衣。
五湖四海为上客，皆因夙世种菩提，个个都是真罗汉，披搭如来三等衣。

金乌玉兔东复西，为人切莫用心机，百年世事三更梦，万里乾坤一局棋。
禹开九州汤放桀，秦吞六国汉登基，古来多少英雄汉，南北山头卧土泥。
黄袍换得紫袈裟，只为当年一念差，我本西方一衲子，为何生在帝王家？
十八年来不自由，南征北讨几时休？我今撒手西方去，不管千秋与万秋。
</code></pre><p>我们的文化就是这样，每逢出大事就往宗教方面去想，有句话是这么说的“精神病不能成为犯罪分子逃脱罪责的附身符”，有的人被以精神病的名义抓捕，而有的人却以精神病的名义离身，文化其实就是这么个东西，没啥鸟用。</p>
        
          <p class="article-more-link">
            <a class="btn btn-primary" href="/2017/10/05/wutaishan/#more">Read More</a>
          </p>
        
      
    </div>

    

    <footer class="article-footer">
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/travel/">travel</a></li></ul>


    </footer>
  </div>
  
</article>

  
    <article id="post-taishan" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/26/taishan/">56. 泰山</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2017/09/26/taishan/" class="article-date"><time datetime="2017-09-26T03:11:42.000Z" itemprop="datePublished">2017-09-26</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/travel/">travel</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>一</p>
<p>国庆的时候，有龙就叫我一起来夜爬泰山。节假日景区都异常的拥挤，就说太麻烦，不去。后来他就把车票和门票都退了，我们自己去香山进香古道爬了一次东山村。上周狗牙山徒步回来后，我问起，说这周来泰山，两人毫不犹豫的就决定了。</p>
<p>周二看了下攻略，周三就买了来回的车票。出去玩都遵循第一天出门可以下班后走，就看时间，刚好有一次K51从北京到日照的火车，晚上23：06分走，早上六点过到泰山只要78元，就定了这张车票。刚开始还想爬完泰山，晚上赶去济南市区，从济南坐高铁回北京。后来想，泰安也有高铁，去济南市区也只是吃一顿饭，就选择从泰安回，买了周日下午14：00的G42次车，回到北京差不多4点，我回回龙观应该不到19点，正合适。我还预定了泰山红门附近的青年旅社。</p>
<p>毕竟第一次来泰安，很多东西完全不知道，还想求一本入泰安进城务工防骗指南。问了下小逸，她也没来过泰山，让我问老大。在狗牙山的途中，听他们说起，泰山有三条路可以走，最经典的就是中天门到南天门这一条，但是这一条走的人特别的多；最有意思的还是后山那条路，特别漂亮，多的就没说什么了。小闲还说多喝水来多看报，便宜不贪多吃瓜，小明还把晓铮那天在朋友圈的评论拖出来，越漂亮的女人越会骗人。</p>
        
          <p class="article-more-link">
            <a class="btn btn-primary" href="/2017/09/26/taishan/#more">Read More</a>
          </p>
        
      
    </div>

    

    <footer class="article-footer">
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/travel/">travel</a></li></ul>


    </footer>
  </div>
  
</article>

  
    <article id="post-manage" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/25/manage/">55. 开源很伟大，但它并不能点石成金</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2017/09/25/manage/" class="article-date"><time datetime="2017-09-25T14:22:48.000Z" itemprop="datePublished">2017-09-25</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/read/">read</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>这是《大教堂与集市》一书中讲到 Mozilla 项目开源遇到问题时的一句名言。</p>
<p>读着书中的黑客圈简史，部分层面上来说，就是一部开源运动史，难怪对该书的评价是开源运动的“圣经”。对开源的概念，更多的时候是从Linux系统开始的，而这或许也正是开源最成功的项目，受益者众。</p>
<p>记得几年前，读着一份<a href="http://man.chinaunix.net/linux/gentoo/gentoo/gentoo/index.htm" target="_blank" rel="external">Gentoo 手册 (2004.2, x86)</a>，被开源这种思绪和新奇折服着。感谢开源世界，给了我们这么多优秀的操作系统和完美的软件，让普通的我们，也能使用。</p>
        
          <p class="article-more-link">
            <a class="btn btn-primary" href="/2017/09/25/manage/#more">Read More</a>
          </p>
        
      
    </div>

    

    <footer class="article-footer">
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/read/">read</a></li></ul>


    </footer>
  </div>
  
</article>

  
    <article id="post-nanjing" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/25/nanjing/">54. 南京</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2017/09/25/nanjing/" class="article-date"><time datetime="2017-09-25T05:12:10.000Z" itemprop="datePublished">2017-09-25</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/travel/">travel</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>一</p>
<p>来南京这次，原本是过久的事，上次联系到曹慧说，她来带我逛，就匆忙决定了。结果买票那天也还说。昨天要来时，发觉曹慧从马鞍山过来不远，但是时间也不多，感觉没必要弄的这么麻烦，就告诉她不要来了。</p>
<p>其实可以按时下班，先回家再来北京站的，图方便，就晚一个小时下班，直接来北京站。</p>
<p>来到北京站，人还是一如既往的多，只是比春运稍微好一些。看时间也不早不晚，还有一个小时的时间，去肯德基买了两个鸡腿，里面也没空位，就出来进站。去候车室，人满为患不为过。在过道里走走，买了一桶泡面和一盒好吃点。</p>
<p>等了差不多四十分钟，进站了，看着拥挤的人群，我预感到这次坐车不会顺利。检票进站时，一大堆行李扑面而来，两个检票口根本不管用，大家都想早点进去，弄的检票速度更慢了。一看前后都是大行李箱，还碰到了我。我直接退出来，说你们进吧。真不明白，每次坐车都会有这么多人，拖家带口的，跟搬家一样的坐火车。进去一波后，我还是跟着挤。后面人说你使劲往里挤，要不走不动。我算是挪过去了，终于可以找14号车厢了。走了好一段距离，来到14号车厢门口，结果人都堵在门口，哪里进得去。一开始还以为是里面放行李的人多，慢一点也正常。可是足足等了不止10分钟，还是毫无进展。我挤进去才看到14号车厢进门处的人根本就没有往里走，而是挤在那里不知道在抢什么。我又站着不动，还是没动静。偶尔才听到人说话，似乎是在补卧铺票。我一下子就不开心了，一上车就来补卧铺，再添一点钱直接坐高铁不就得了呀。</p>
        
          <p class="article-more-link">
            <a class="btn btn-primary" href="/2017/09/25/nanjing/#more">Read More</a>
          </p>
        
      
    </div>

    

    <footer class="article-footer">
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/travel/">travel</a></li></ul>


    </footer>
  </div>
  
</article>

  
    <article id="post-city" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/24/city/">53. 聆听两座城</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2017/09/24/city/" class="article-date"><time datetime="2017-09-24T12:55:24.000Z" itemprop="datePublished">2017-09-24</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/travel/">travel</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>来黔西已经十天，对这座城市也渐渐熟悉。学校开学一周，也走上打杂的工作之路。</p>
<p>中午来到水西公园。它是以明正德年间修建观音阁为基础，在民国初年改建为水西公园。往里走爬上门边的小山，就是半山亭和观文塔。观文塔是黔西古城的标志，始建于1726年。虽然只能仰头看模糊的塔尖，但七层的高度的确在公园门旁突显。塔上面长着青草和盆景，给单调的孤塔略加殊色。只是看着紧锁的大门，有一丝凉意。在中国的每一处地方，比如塔、庙之类的有点历史渊源的处所，总是深门紧锁，把人们拒之门外，似乎在向人们表明一种不可触碰的威严。这的确是一种奇怪的现象。按理说，有历史渊源有纪念意义，应该是让人骄傲自豪的最好表达，应该有足够的勇气和信心，告诉到来的每一个人，让他们面对皓月长天，回想起这一段深情往事，自然而生一种敬畏和内心深处的自豪。</p>
        
          <p class="article-more-link">
            <a class="btn btn-primary" href="/2017/09/24/city/#more">Read More</a>
          </p>
        
      
    </div>

    

    <footer class="article-footer">
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/travel/">travel</a></li></ul>


    </footer>
  </div>
  
</article>

  
    <article id="post-school" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/22/school/">52. 不恋这座城</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2017/09/22/school/" class="article-date"><time datetime="2017-09-22T11:24:59.000Z" itemprop="datePublished">2017-09-22</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/travel/">travel</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>这是2012年末第一次参加工作时对一个陌生城市的感受，看到这篇日志时，桃子说：“我已经在我这座小城的主干道来回徘徊了无数次。我都不知道自己在来回地徘徊什么。也许是我在寻找着什么。可是我暂时找不到”。有些东西，有些事从一开始就注定不会长久，好在自己知道为什么，时刻准备着要走。这一走，离开这座城市5个年头了，回头看着这些忧虑和伤感，感谢这些经历，让自己终于走得过来。</p>
        
          <p class="article-more-link">
            <a class="btn btn-primary" href="/2017/09/22/school/#more">Read More</a>
          </p>
        
      
    </div>

    

    <footer class="article-footer">
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/travel/">travel</a></li></ul>


    </footer>
  </div>
  
</article>

  
    <article id="post-mysqlbase" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/22/mysqlbase/">51. 高性能MySQL笔记-事务</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2017/09/22/mysqlbase/" class="article-date"><time datetime="2017-09-22T10:05:05.000Z" itemprop="datePublished">2017-09-22</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/mysql/">mysql</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="一、MySQL逻辑架构"><a href="#一、MySQL逻辑架构" class="headerlink" title="一、MySQL逻辑架构"></a>一、MySQL逻辑架构</h2><p>为了充分发挥MySQL的性能并顺利地使用，就必须理解其设计。</p>
<h3 id="1-逻辑架构"><a href="#1-逻辑架构" class="headerlink" title="1. 逻辑架构"></a>1. 逻辑架构</h3><p>最上层的服务并不是MySQL所独有的，大多数基于网络的客户端/服务器的工具或者服务都有类似的架构。比如连接处理、授权认证、安全等等。</p>
<p>第二层架构是MySQL比较有意思的部分。大多数MySQL的核心服务功能都在这一层，包括查询解析、分析、优化、缓存以及所有的内置函数（例如，日期、时间、数学和加密函数），所有跨存储引擎的功能都在这一层实现：存储过程、触发器、视图等。</p>
<p>第三层包含了存储引擎。存储引擎负责MySQL中数据的存储和提取。和GNU/Linux下的各种文件系统一样，每个存储引擎都有它的优势和劣势。服务器通过API与存储引擎进行通信。这些接口屏蔽了不同存储引擎之间的差异，使得这些差异对上层的查询过程透明。存储引擎不会去解析SQL（InnoDB是一个例外，它会去解析外键定义，因为MySQL服务器本身没有实现该功能），不同存储引擎之间也不会相互通信，而只是简单的响应上层服务器的请求。</p>
        
          <p class="article-more-link">
            <a class="btn btn-primary" href="/2017/09/22/mysqlbase/#more">Read More</a>
          </p>
        
      
    </div>

    

    <footer class="article-footer">
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li></ul>


    </footer>
  </div>
  
</article>

  
    <article id="post-cut" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/21/cut/">50. 绳子和剪刀</a>
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/2017/09/21/cut/" class="article-date"><time datetime="2017-09-21T12:58:01.000Z" itemprop="datePublished">2017-09-21</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/php/">php</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>这是之前遇到过的一个面试题，说实话，当时想到了开头，但没能进行下去，毕竟循环的条件和结束循环的条件并不容易找。而且要求在纸上手写代码，有点紧张，错误连篇。当他说完的那一刻，我已经在心里默默算出了答案，但似乎跟他的要求不相符，就一直没能说出来。</p>
<p>题目是这样的：有一根绳子，奇数长度时从一端减去1米长的一段，偶数长度时从中间剪断，你写一个程序，把这根绳子全部剪成1米长的小段，需要几刀？</p>
<p>刀数是显而易见的，就是绳子的长度减1，但是无法表达出如何实现这一过程，我写了开头，就没能在写下去。今天刚好在家没事，突然想起这个问题，觉得肯定能用代码描述这个过程。想了整整一个下午，都没有解决这个问题，后来我还画了这个图</p>
<p>想是不是将一根绳子拆分成类似一棵树会简单一些，即统计树的最底下一层的1个数就可以知道最终剪了几刀。但是用PHP实现这样一棵树，显然是把这个问题想复杂了，不应该有这么复杂的，但是递归一时半会又不知道怎么实现。</p>
        
          <p class="article-more-link">
            <a class="btn btn-primary" href="/2017/09/21/cut/#more">Read More</a>
          </p>
        
      
    </div>

    

    <footer class="article-footer">
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/php/">php</a></li></ul>


    </footer>
  </div>
  
</article>

  


  <div id="page-nav">
    <nav><ul class="pagination"><li class="disabled"><span class="page-prev"><i class="fa fa-chevron-left"></i> Prev</a></li><li class="active"><span class="page-number">1</span></li><li><a class="page-number" href="/page/2/">2</a></li><li><a class="page-number" href="/page/3/">3</a></li><li class="disabled"><span class="page-space">&hellip;</span></li><li><a class="page-number" href="/page/6/">6</a></li><li><a class="page-next" rel="next" href="/page/2/">Next <i class="fa fa-chevron-right"></i></a></li></ul></nav>
  </div>



          </div>
          <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
            
  
  <div class="sidebar-module">
    <h4>Categories</h4>
    <ul class="sidebar-module-list"><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/categories/apache/">apache</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/categories/go/">go</a><span class="sidebar-module-list-count">10</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/categories/mysql/">mysql</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/categories/php/">php</a><span class="sidebar-module-list-count">20</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/categories/read/">read</a><span class="sidebar-module-list-count">6</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/categories/travel/">travel</a><span class="sidebar-module-list-count">19</span></li></ul>
  </div>



  
  <div class="sidebar-module">
    <h4>Recents</h4>
    <ul class="sidebar-module-list">
      
        <li>
          <a href="/2017/11/13/yaf/">58. 用Yaf写一句hello</a>
        </li>
      
        <li>
          <a href="/2017/11/11/flow/">58. 流量切分</a>
        </li>
      
        <li>
          <a href="/2017/10/05/wutaishan/">57. 五台山</a>
        </li>
      
        <li>
          <a href="/2017/09/26/taishan/">56. 泰山</a>
        </li>
      
        <li>
          <a href="/2017/09/25/manage/">55. 开源很伟大，但它并不能点石成金</a>
        </li>
      
    </ul>
  </div>


  <div class="sidebar-module">
  <h4>Friends</h4>
  <ul class="sidebar-module-list">
      <li><a href="http://www.lxzfranky.com" target="_blank">Franky's Diary</a></li>
      <li><a href="http://lyj1215.com" target="_blank">lyjの博客</a></li>
      <li><a href="https://wenqixiang.com" target="_blank">聞其詳的個人網站</a></li>
      <li><a href="https://oef.org.cn" target="_blank">开放教育反应堆</a></li>
  </ul>
</div>


          </div>
        
    </div>
  </div>
  <footer class="blog-footer">
  <div class="container">
    <div id="footer-info" class="inner">
      &copy; 2017 <a href="https://github.com/zhgxun" target="_blank"> by 张广训</a><br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, and theme base on <a href="https://github.com/cgmartin/hexo-theme-bootstrap-blog" target="_blank">hexo-theme-bootstrap-blog.</a>
    </div>
  </div>
</footer>

  <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>

<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>



<script src="/js/script.js"></script>

</body>
</html>
